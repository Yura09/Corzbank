<div class="wallet">
	<div class="cards-deposits">
		<div
			class="option show-cards-title"
			(click)="cardsIsDisplayed = !cardsIsDisplayed"
		>
			<div class="selected-option" *ngIf="cardsIsDisplayed"></div>
			<div class="option-title">
				<h2>Cards</h2>
				<hr />
			</div>
		</div>
		<div class="cards" *ngIf="cardsIsDisplayed">
			<div
				class="card"
				[ngClass]="{
					credit: card.cardType == 1,
					debit: card.cardType == 2,
					universal: card.cardType == 3
				}"
				*ngFor="let card of cards"
				(click)="selectCard(card.id)"
			>
				<div class="title">
					<span class="bank-name">corzbank </span>
					<small> | </small>
					<span class="card-type">
						{{ CardType[card.cardType] }} card</span
					>
				</div>
				<div class="card-field">
					<span class="card-number">{{
						cardNumberConvertor(card.cardNumber, true)
					}}</span>
					<span class="expiration-date">{{ card.expirationDate }}</span>
				</div>
				<div class="card-field">
					<span class="balance">{{ card.balance }}$</span>
					<span class="payment-system">{{
						PaymentSystem[card.paymentSystem]
					}}</span>
				</div>
			</div>
		</div>
		<div class="option" (click)="depositsIsDisplayed = !depositsIsDisplayed">
			<div class="selected-option" *ngIf="depositsIsDisplayed"></div>
			<div class="option-title">
				<hr />
				<h2>Deposits</h2>
				<hr />
			</div>
		</div>
		<div class="deposits" *ngIf="depositsIsDisplayed"></div>
	</div>
	<div class="details-block" *ngIf="cardsIsDisplayed && cardDataIsDisplayed">
		<div class="details">
			<div class="option">
				<div class="option-title">
					<div>
						<h2>{{ CardType[selectedCard?.cardType] }} Card</h2>
					</div>
					<div class="functions">
						<div class="icon" (click)="getTransfers()">
							<i class="fas fa-archive"></i>
						</div>
						<div class="icon" (click)="openTransferMenu()">
							<i class="fas fa-angle-double-right"></i>
						</div>
						<div class="icon"(click)="openSettings()">
							<i class="fas fa-cog"></i>
						</div>
					</div>
				</div>
			</div>
			<div class="card-data">
				<div class="main-data">
					<span
						class="card-number"
						(click)="cardNumberIsShown = !cardNumberIsShown"
						>{{
							cardNumberConvertor(
								selectedCard?.cardNumber,
								!cardNumberIsShown
							)
						}}</span
					>
					<div class="date-cvv">
						<span class="expiration-date">{{
							selectedCard?.expirationDate
						}}</span>
						<span class="cvv" (click)="cvvIsShown = !cvvIsShown">{{
							cvvIsShown ? selectedCard?.cvvCode : "* * *"
						}}</span>
					</div>
				</div>
				<div class="balance">
					<h2>Balance</h2>
					<h1>{{ selectedCard?.balance }}$</h1>
				</div>
			</div>
		</div>
		<div *ngIf="transactionsIsDisplayed">
			<div class="title-transactions">
				<h2>Transactions</h2>
			</div>
			<div class="transactions">
				<h1 *ngIf="transfers.length === 0">
					You do not have any transfers
				</h1>
				<div
					class="transaction"
					*ngFor="let transfer of transfers.slice().reverse()"
				>
					<i class="fas fa-archive icon transfer-field"></i>
					<span class="description transfer-field"
						>{{ TransferType[transfer.transferType] }} transfer</span
					>
					<div class="price">
						<span
							*ngIf="
								transfer.senderCardId === selectedCard.id;
								else transferToMe
							"
							>-</span
						>
						<ng-template #transferToMe>+</ng-template>
						<span class="transfer-field">{{ transfer.amount }}$</span>
					</div>
				</div>
			</div>
		</div>
		<div *ngIf="transferMenuIsDisplayed">
			<div class="title-transfers title-transactions">
				<h2>Transfer to Card</h2>
			</div>
			<form [formGroup]="transferForm">
				<div class="transfer">
					<div class="field">
						<input
							formControlName="receiverCardNumber"
							type="text"
							maxlength="28"
							placeholder="**** **** **** ****"
							maxlength="16"
							class="form-control"
						/>
						<small
							*ngIf="
								receiverPhoneNumber &&
								receiverPhoneNumber.invalid &&
								receiverPhoneNumber.touched
							"
							>Card Number is Required</small
						>
					</div>
					<div class="field">
						<input
							formControlName="note"
							type="text"
							placeholder="Note"
							class="form-control"
						/>
					</div>
					<div class="field">
						<input
							formControlName="amount"
							type="text"
							placeholder="Amount"
							class="form-control"
						/>
						<small *ngIf="amount && amount.invalid && amount.touched"
							>Amount is Required</small
						>
					</div>
					<div class="submit-button">
						<button
							(click)="sendTransfer()"
							[disabled]="transferForm.invalid"
						>
							Send
						</button>
					</div>
				</div>
			</form>
		</div>
		<div *ngIf="settingsIsDisplayed">
			<div class="title-settings title-transactions">
				<h2>Settings</h2>
			</div>
			<div class="settings">
				<h1>First setting</h1>
				<h1>Second setting</h1>
				<h1>Third setting</h1>
			</div>
		</div>
	</div>
</div>
